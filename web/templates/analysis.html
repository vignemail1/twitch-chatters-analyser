{{ define "analysis_page" }}
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="utf-8" />
    <title>{{ .Title }}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="/static/css/main.css" rel="stylesheet" />
</head>
<body class="dark">
<header>
    <h1>Twitch Chatters Analyser</h1>
    <div class="user-info">
        {{ if .CurrentUser }}
            Connecté en tant que <strong>{{ .CurrentUser.DisplayName }}</strong> ({{ .CurrentUser.Login }})
            <p><a href="/channels">Voir mes chaînes modérées</a></p>
            <p><a href="/analysis">Voir l'analyse de la session</a></p>
        {{ else }}
            <a href="/auth/login">Se connecter avec Twitch</a>
        {{ end }}
    </div>
</header>
<main>
<h2>Analyse de la session</h2>

<p>Session UUID : {{ .SessionUUID }}</p>
{{ if .Summary }}
<p>Nombre total de comptes distincts : {{ .Summary.TotalAccounts }}</p>
<p>Données générées le : {{ .Summary.GeneratedAt }}</p>

<h3>Top 10 des jours de création de comptes</h3>

{{ if not .Summary.TopDays }}
    <p>Aucune donnée disponible (pas de chatters capturés ou pas encore enrichis).</p>
{{ else }}
    <table>
        <thead>
        <tr>
            <th>Date</th>
            <th>Nombre de comptes</th>
        </tr>
        </thead>
        <tbody>
        {{ range .Summary.TopDays }}
            <tr>
                <td>{{ .Date }}</td>
                <td>{{ .Count }}</td>
            </tr>
        {{ end }}
        </tbody>
    </table>
{{ end }}
{{ else }}
    <p>Aucun résumé disponible pour cette session.</p>
{{ end }}
</main>
</body>
</html>
{{ end }}
